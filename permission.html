<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÑ‡∏õ‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß üíï</title>
<style>
body{
    font-family: Arial;
    background:#ffe6f2;
    text-align:center;
    padding:20px;
}
.box{
    background:white;
    padding:20px;
    border-radius:15px;
    max-width:400px;
    margin:auto;
    box-shadow:0 5px 15px rgba(0,0,0,0.2);
}
input{
    width:90%;
    padding:8px;
    margin:8px;
}
button{
    padding:10px 15px;
    margin:5px;
    border:none;
    border-radius:10px;
    cursor:pointer;
}
.primary{ background:#ff4da6; color:white; }
.allow{ background:#4CAF50; color:white; }
.deny{ background:#f44336; color:white; }
.linkBox{
    background:#f2f2f2;
    padding:10px;
    word-break:break-all;
}
</style>
</head>
<body>

<div class="box" id="requestPage">
<h2>üíå ‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÑ‡∏õ‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß</h2>

<input type="text" id="place" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà">
<input type="text" id="withWho" placeholder="‡πÑ‡∏õ‡∏Å‡∏±‡∏ö‡πÉ‡∏Ñ‡∏£‡∏ö‡πâ‡∏≤‡∏á">
<input type="time" id="backTime">
<br>
<button class="primary" onclick="createLink()">‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï</button>

<div id="output"></div>
</div>

<div class="box" id="approvePage" style="display:none;">
<h2>üì© ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï</h2>
<p id="showData"></p>
<button class="allow" onclick="sendBack('‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï')">‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï üíö</button>
<button class="deny" onclick="sendBack('‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï')">‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï ‚ùå</button>
</div>

<script>

const params = new URLSearchParams(window.location.search);
const place = params.get("place");
const withWho = params.get("with");
const backTime = params.get("time");
const result = params.get("result");

if(place && withWho && backTime && !result){
    document.getElementById("requestPage").style.display="none";
    document.getElementById("approvePage").style.display="block";

    document.getElementById("showData").innerHTML =
    "üìç ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà: "+place+"<br>"+
    "üë´ ‡πÑ‡∏õ‡∏Å‡∏±‡∏ö: "+withWho+"<br>"+
    "‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏•‡∏±‡∏ö: "+backTime;
}

if(result){
    document.getElementById("output").innerHTML =
    "<h3>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï: "+result+"</h3>";
}

function createLink(){
    const p = document.getElementById("place").value;
    const w = document.getElementById("withWho").value;
    const t = document.getElementById("backTime").value;

    const link = window.location.origin + window.location.pathname +
    "?place="+encodeURIComponent(p)+
    "&with="+encodeURIComponent(w)+
    "&time="+encodeURIComponent(t);

    document.getElementById("output").innerHTML =
    "<div class='linkBox'>"+link+"</div>"+
    "<button onclick='copyLink(\""+link+"\")'>‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå</button>";
}

function copyLink(link){
    navigator.clipboard.writeText(link);
    alert("‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß üíï");
}

function sendBack(answer){
    const backLink =
    window.location.origin + window.location.pathname +
    "?result="+encodeURIComponent(answer);

    window.location.href = backLink;
}

</script>

</body>
</html>
